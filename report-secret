# ライブラリのインストールと公開鍵の取得
!pip install cryptography
!wget https://raw.githubusercontent.com/ybktr/literacy/main/yabuki-public.pem

# Step 1: 学籍番号をファイルに書き込む
student_id = "W25G3116"
with open("report.txt", "w") as f:
    f.write(student_id)

# Step 2: 公開鍵を読み込む
from cryptography.hazmat.primitives import serialization
from cryptography.hazmat.primitives.asymmetric import padding
from cryptography.hazmat.primitives import hashes

with open("yabuki-public.pem", "rb") as key_file:
    public_key = serialization.load_pem_public_key(key_file.read())

# Step 3: ファイルを読み込んで暗号化
with open("report.txt", "rb") as f:
    message_data = f.read()

encrypted = public_key.encrypt(
    message_data,
    padding.OAEP(
        mgf=padding.MGF1(algorithm=hashes.SHA256()),
        algorithm=hashes.SHA256(),
        label=None
    )
)

# Step 4: 暗号化された内容をファイルとして保存
with open("report-secret", "wb") as f:
    f.write(encrypted)

print("✅ 完了！ファイル 'report-secret' が作成されました。")
